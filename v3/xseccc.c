// cross section weight function

double xseccc(int type,double energy)
{

  int nenergy;
  int ntype;
  double xsec;
  double xnm[100] = {
    55.7, 53.3, 49.9, 47.1, 45.0, 44.0, 43.2, 42.5, 42.0, 41.8,
    41.7, 41.5, 41.3, 41.1, 41.0, 40.8, 40.6, 40.5, 40.3, 40.1,
    40.0, 39.9, 39.8, 39.7, 39.6, 39.5, 39.4, 39.4, 39.3, 39.2,
    39.2, 39.1, 39.1, 39.0, 39.0, 38.9, 38.9, 38.8, 38.8, 38.7,
    38.7, 38.7, 38.6, 38.6, 38.6, 38.5, 38.5, 38.5, 38.4, 38.4,
    38.4, 38.3, 38.3, 38.3, 38.3, 38.2, 38.2, 38.2, 38.1, 38.1,
    38.1, 38.1, 38.1, 38.0, 38.0, 38.0, 38.0, 38.0, 37.9, 37.9,
    37.9, 37.9, 37.9, 37.9, 37.8, 37.8, 37.8, 37.8, 37.8, 37.8,
    37.8, 37.7, 37.7, 37.7, 37.7, 37.7, 37.7, 37.7, 37.7, 37.7,
    37.6, 37.6, 37.6, 37.6, 37.6, 37.6, 37.6, 37.6, 37.6, 37.6};
  double xnmbar[100] = {
    13.2, 17.2, 19.0, 19.6, 19.6, 19.6, 19.5, 19.4, 19.3, 19.4,
    19.5, 19.6, 19.6, 19.6, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6,
    19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6, 19.6,
    19.6, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7};
  double xne[100] = {
    61.4, 55.6, 51.3, 48.4, 46.2, 44.7, 43.8, 43.1, 42.5, 42.2,
    41.9, 41.7, 41.5, 41.3, 41.1, 40.9, 40.7, 40.6, 40.4, 40.3,
    40.1, 40.0, 39.9, 39.8, 39.7, 39.6, 39.5, 39.4, 39.4, 39.3,
    39.2, 39.2, 39.1, 39.1, 39.0, 39.0, 38.9, 38.9, 38.8, 38.8,
    38.8, 38.7, 38.7, 38.6, 38.6, 38.6, 38.5, 38.5, 38.5, 38.4,
    38.4, 38.4, 38.3, 38.3, 38.3, 38.3, 38.2, 38.2, 38.2, 38.2,
    38.1, 38.1, 38.1, 38.1, 38.1, 38.0, 38.0, 38.0, 38.0, 38.0,
    37.9, 37.9, 37.9, 37.9, 37.9, 37.9, 37.8, 37.8, 37.8, 37.8,
    37.8, 37.8, 37.8, 37.7, 37.7, 37.7, 37.7, 37.7, 37.7, 37.7,
    37.7, 37.7, 37.6, 37.6, 37.6, 37.6, 37.6, 37.6, 37.6, 37.6};
  double xnebar[100] = {
    15.3, 18.4, 19.8, 20.2, 20.2, 20.1, 19.9, 19.8, 19.6, 19.6,
    19.7, 19.7, 19.7, 19.8, 19.8, 19.8, 19.8, 19.8, 19.8, 19.8,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7,
    19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7, 19.7};

  nenergy = energy;
  ntype = type;

  if (nenergy>99) nenergy=99;
  
  if (ntype==56) xsec = xnm[nenergy+1]*energy;
  if (ntype==55) xsec = xnmbar[nenergy+1]*energy;
  if (ntype==53) xsec = xne[nenergy+1]*energy;
  if (ntype==52) xsec = xnebar[nenergy+1]*energy;
		    
  return xsec * 4.09e9;
  
  // 10**-38 cm2 * 10**6 kg/kton * 3.8e20 POT/year *1iron/56/1.66e-27kg
  // * 10**-4 m2/cm2 = 4.09e9 conversion factor
  // since table was 26*sigma(nu-proton) + 30*sigma(nu-neutron)
}
